{"version":3,"sources":["../node_modules/@material-ui/icons/Error.js","../node_modules/@material-ui/icons/CloudUpload.js","../../../../src/ui/ImageUpload/defaultTranslations.tsx","../../../../src/ui/ImageUpload/ImageUpload.tsx"],"names":["_interopRequireDefault","require","_interopRequireWildcard","Object","defineProperty","exports","value","default","React","_default","createElement","d","buttonContent","noFileError","badExtensionError","tooBigError","uploadingError","unknownError","_this","a","e"],"mappings":"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","file":"static/js/16.8f67ac5a.chunk.js","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z\"\n}), 'Error');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z\"\n}), 'CloudUpload');\n\nexports.default = _default;","export var defaultTranslations = {\n    buttonContent: 'Upload image',\n    noFileError: 'No file selected',\n    badExtensionError: 'Bad file type',\n    tooBigError: 'Too big',\n    uploadingError: 'Error while uploading',\n    unknownError: 'Unknown error',\n};\n//# sourceMappingURL=defaultTranslations.js.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport React from 'react';\nimport Button from '@material-ui/core/Button';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload';\nimport ErrorIcon from '@material-ui/icons/Error';\nimport { defaultTranslations } from './defaultTranslations';\nimport { useUiTranslator } from '../../core/components/hooks';\nvar NO_FILE_ERROR_CODE = 1;\nvar BAD_EXTENSION_ERROR_CODE = 2;\nvar TOO_BIG_ERROR_CODE = 3;\nvar UPLOADING_ERROR_CODE = 4;\n/*\n * FIXME: rewrite to functional component\n */\nvar ImageUpload = /** @class */ (function (_super) {\n    __extends(ImageUpload, _super);\n    function ImageUpload() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.state = {\n            isUploading: false,\n            hasError: false,\n            errorText: '',\n            progress: 0,\n        };\n        _this.hasExtension = function (fileName) {\n            var patternPart = _this.props.allowedExtensions\n                ? _this.props.allowedExtensions.map(function (a) { return a.toLowerCase(); }).join('|')\n                : '';\n            var pattern = '(' + patternPart.replace(/\\./g, '\\\\.') + ')$';\n            return new RegExp(pattern, 'i').test(fileName.toLowerCase());\n        };\n        _this.handleError = function (errorCode) {\n            var errorText = '';\n            switch (errorCode) {\n                case NO_FILE_ERROR_CODE:\n                    errorText = _this.props.t(_this.props.translations.noFileError);\n                    break;\n                case BAD_EXTENSION_ERROR_CODE:\n                    errorText = _this.props.t(_this.props.translations.badExtensionError);\n                    break;\n                case TOO_BIG_ERROR_CODE:\n                    errorText = _this.props.t(_this.props.translations.tooBigError);\n                    break;\n                case UPLOADING_ERROR_CODE:\n                    errorText = _this.props.t(_this.props.translations.uploadingError);\n                    break;\n                default:\n                    errorText = _this.props.t(_this.props.translations.unknownError);\n                    break;\n            }\n            // Need to flick \"isUploading\" because otherwise the handler doesn't fire properly\n            _this.setState({ hasError: true, errorText: errorText, isUploading: true }, function () {\n                return _this.setState({ isUploading: false });\n            });\n            setTimeout(function () { return _this.setState({ hasError: false, errorText: '' }); }, 5000);\n        };\n        _this.handleFileSelected = function (e) {\n            if (!e.target.files || !e.target.files[0]) {\n                _this.handleError(NO_FILE_ERROR_CODE);\n                return;\n            }\n            var file = e.target.files[0];\n            if (!_this.hasExtension(file.name)) {\n                _this.handleError(BAD_EXTENSION_ERROR_CODE);\n                return;\n            }\n            if (file.size > _this.props.maxFileSize) {\n                _this.handleError(TOO_BIG_ERROR_CODE);\n                return;\n            }\n            if (_this.props.imageLoaded) {\n                _this.readFile(file).then(function (data) { return _this.props.imageLoaded(data); });\n            }\n            if (_this.props.imageUpload) {\n                _this.setState({ isUploading: true });\n                _this.props\n                    .imageUpload(file, _this.handleReportProgress)\n                    .then(function (resp) {\n                    _this.setState({ progress: undefined, isUploading: false });\n                    _this.props.imageUploaded && _this.props.imageUploaded(resp);\n                })\n                    .catch(function (error) {\n                    _this.setState({ isUploading: false });\n                    _this.props.imageUploadError && _this.props.imageUploadError(error);\n                });\n            }\n        };\n        _this.handleFileUploadClick = function () {\n            return _this.fileInput.click();\n        };\n        _this.handleReportProgress = function (progress) { return _this.setState({ progress: progress }); };\n        _this.renderChildren = function () {\n            if (_this.state.isUploading) {\n                return React.createElement(CircularProgress, { value: _this.state.progress, size: 19 });\n            }\n            if (_this.state.hasError) {\n                return (React.createElement(React.Fragment, null,\n                    _this.state.errorText,\n                    React.createElement(ErrorIcon, { style: { marginLeft: '8px' } })));\n            }\n            return (React.createElement(React.Fragment, null,\n                _this.props.translations.buttonContent,\n                _this.props.icon));\n        };\n        return _this;\n    }\n    ImageUpload.prototype.readFile = function (file) {\n        return new Promise(function (resolve, reject) {\n            var reader = new FileReader();\n            // Read the image via FileReader API and save image result in state.\n            reader.onload = function (e) {\n                // Add the file name to the data URL\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                var dataUrl = e.target.result;\n                dataUrl = dataUrl.replace(';base64', \";name=\" + file.name + \";base64\");\n                resolve({ file: file, dataUrl: dataUrl });\n            };\n            reader.readAsDataURL(file);\n        });\n    };\n    ImageUpload.prototype.render = function () {\n        var _this = this;\n        return (React.createElement(React.Fragment, null,\n            React.createElement(Button, { disabled: this.state.isUploading, variant: \"contained\", color: this.state.hasError ? 'secondary' : 'primary', onClick: this.handleFileUploadClick, style: this.props.style, size: \"small\" }, this.renderChildren()),\n            !this.state.isUploading && (React.createElement(\"input\", { style: { display: 'none' }, ref: function (fileInput) { return (_this.fileInput = fileInput); }, type: \"file\", onChange: this.handleFileSelected }))));\n    };\n    ImageUpload.defaultProps = {\n        icon: React.createElement(CloudUploadIcon, { style: { marginLeft: '8px' } }),\n        allowedExtensions: ['jpg', 'jpeg', 'png'],\n        maxFileSize: 5242880,\n        translations: defaultTranslations,\n    };\n    return ImageUpload;\n}(React.Component));\nexport default (function (props) {\n    var t = useUiTranslator().t;\n    return React.createElement(ImageUpload, __assign({}, props, { t: t }));\n});\n//# sourceMappingURL=ImageUpload.js.map"],"sourceRoot":""}